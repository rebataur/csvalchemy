{'name': 'convert_str_to_date', 'type': 'CALCULATION', 'return_type': 'DATE', 'function_code': 'CREATE OR REPLACE FUNCTION public.convert_str_to_date(column_name text)\r\n RETURNS date\r\n LANGUAGE plpython3u\r\nAS $function$\r\n# EQ180123.csv\r\n# Verify input\r\nimport datetime\r\n\r\ndt = column_name[2:-4] \r\nif len(dt) != 6 and not dt.isdigit():\r\n\treturn "1900-12-12"\r\n\t\r\ndate_string = f\'20{dt[-2:]}-{dt[2:-2]}-{dt[:2]}\'\r\n\r\ndate_format = \'%Y-%m-%d\'\r\n\r\ntry:\r\n\r\n   # formatting the date using strptime() function\r\n   dateObject = datetime.datetime.strptime(date_string, date_format)\r\n   \r\n\r\n# If the date validation goes wrong\r\nexcept ValueError:   \t\r\n   # printing the appropriate text if ValueError occurs\r\n   return "1900-12-12"\r\n   \r\n\r\nreturn date_string\r\n$function$\r\n;', 'test_code': "select convert_str_to_date('EQ090623.CSV')", 'return_sql': 'convert_str_to_date({column_name}) as {name}', 'args': [{'name': 'column_name', 'type': 'COLUMN'}]}